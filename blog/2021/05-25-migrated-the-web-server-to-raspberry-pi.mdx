---
title: "サーバーをRaspberry Piに移行しました"
slug: migrated-the-web-server-to-raspberry-pi
date_published: 2021-05-25T08:00:00.000Z
date_updated: 2021-05-25T08:00:00.000Z
tags: [ブログ, Raspberry Pi, 自宅サーバー]
---

ヤフオクに出品されていた格安Raspberry Piを落札したので、ウェブサーバーをRaspberry Piへ移行しました。

ウェブサーバーに使用しているラズパイは、Raspberry Pi 3 Model Bです。OSにはRaspberry Pi OS（Raspbian） 64bitをインストールしました。

*Raspberry Pi OSはDebianベースのOSですが、64bitは執筆時点でベータ版です。もしも64bitで使う場合、自己責任で注意して使用してください。*

Raspberry Pi 3 Model B+も手に入ったので、そっちにも64Bitのインストールを試みたんですが、何故か全く動かず、ネットで検索しても同じ状況の人はいても解決策らしい解決策を発見できず諦めました。

*なお実家がPC欲しいって言ってたので、Raspberry Pi OS Desktop 32bitをインストールしてあげました。動作は遅いので多分使い物にならない気はしますけど、コンパクト感は気に入ってくれたらしいので良しとしましよう。*

サーバー間のデータ移行ですが、特に苦労せずぱぱっと終わりました。私のサーバーのサービスはほぼ全て仮想コンテナ化されているので、適当にDockerとDocker-composeをインストールして、コマンド打てばサービスが立ち上がります。とは言っても、この世の中のアーキテクチャを支配しているIntel製CPUからラズパイが使っているARMアーキテクチャへの移行なので、ちょろっといじりはしました。全くARMをサポートしていなくて一から作るみたいなイメージはなかったので、すぐ終わりました。あとはコンテナへアクセスを振り分けるためのNginxとSSL更新用のCertbotも導入すれば完璧です。

本当はこれを機会にNginxもコンテナ化する予定だったのですが、仮想コンテナ化してしまうと、SSL更新のためにコンテナを停止しなくちゃいけなかったり、いくつかの通信は別のPCへ流すっていうリバースプロキシの役割も果たしているので、面倒くさくて止めました。

データベース系は元々のウェブサーバー（私はメインサーバーって呼んでる）で可動しているので、そっちにアクセスしている感じになっています。PostgreSQLを必要としているサービスが一つだけあるので、それだけはコンテナで立ち上げています。コンテンツデータはgitでバックアップ取ってるので、最悪消えても大丈夫。

こんな感じでラズパイへウェブサーバーが移行されました。具体的にどんなことしたのかとかについては、気が向けばあとで投稿しておこうと思います。

---

何故か分からないですけど、移行から一日ぐらいしてラズパイへアクセスできなくなったんですよね。原因がさっぱりなので様子見ということにはしています。もしも問題があったら、メインサーバー（旧ウェブサーバー）に戻すかも知れません。
